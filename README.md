# 政府房产交易系统 (GRETS)

基于Hyperledger Fabric 2.5和Go语言实现的政府房产交易系统，具有Vue前端可视化界面。

## 项目概述

本系统利用区块链技术实现房产交易全流程的透明化、安全化和高效化管理。通过智能合约自动执行交易规则，确保交易的合法性和合规性，同时降低中间环节成本和风险。

## 设计目标
- 去中介化：买卖双方直接交易，降低成本和信任摩擦。
- 透明可审计：所有交易记录在区块链上，政府机构可实时监管。
- 安全可信：通过智能合约强制执行业务逻辑，防止欺诈。
- 合规性：符合政府法规（如产权登记、税收规则）。
- 高性能：基于 Hyperledger Fabric 的联盟链架构，满足高频交易需求。

## 系统架构

### 区块链网络

基于Hyperledger Fabric 2.5构建的联盟链网络，包含以下组织：

1. **政府机构（Government Organization）**
   
   政府是房地产交易的监管主体，负责土地确权、税务管理、合同备案等核心职能。
   - 土地管理局：负责土地权属登记、交易合法性验证。
   - 税务局：处理交易税费计算与缴纳。
   - 不动产登记中心：负责产权登记和过户操作。

2. **银行和金融机构（Banking Organization）**
   
   处理资金结算、按揭贷款等关键环节定义为独立组织，需参与交易的链上资金验证和结算流程。
   - 商业银行：提供贷款审批、资金托管、支付结算。
   - 公证处：可能需参与资金监管或合同公证（某些地区要求）。

3. **投资者（Investor Organizations）**

   交易的直接参与方，需通过链上身份验证并签署交易。
   - 个人买家或卖家

4. **第三方服务提供商（Third-Party Service Provider Organization）**
   
   - 评估机构：对房产价值进行评估（如抵押贷款前的估值）。
   - 法律顾问：对于陷入法律纠纷的房产进行咨询。
   - 保险公司：负责进行保险相关业务的开展。

5. **审计和监管机构（Audit and Regulatory Organization）**
   
   确保交易符合法律法规，处理合同审核、纠纷仲裁等,需具备合同模板审核、违规交易拦截等权限。
   - 监管人员

### 技术栈
| 组件 | 技术选型 |
|------|----------|
| 区块链框架 | Hyperledger Fabric 2.5+（多通道+PDC） |
| 智能合约（链码） | Go语言实现，部署在Fabric网络 |
| 服务端 | Golang（Gin框架），提供REST API |
| 前端 | Vue3 + TypeScript + Pinia状态管理 |
| 链上数据库 | BoltDB（状态数据库） |
| 链下数据库 | MySQL（结构化数据） + IPFS（大文件存储） |
| 辅助工具 | Docker Compose（本地网络部署）、Kubernetes（生产环境） |
| 安全与加密 | Fabric CA、TLS 1.3、AES-256（链下数据加密） |
|部署|Docker|

IPFS客户端：http://119.45.9.196:8888/ipfs/#{cid}
IPFS API端：http://119.45.9.196:5001


## 功能模块

1. **用户管理**：用户注册、认证和权限管理
2. **房产管理**：房产信息登记、查询和更新、产权变更处理
3. **交易管理**：发起交易、交易审批和执行
4. **资金管理**：支付处理、贷款申请和审批
5. **合同管理**：合同生成、签署和存证
6. **审计管理**：审计与争议处理

## 设计思路

1. 由于区块链本身具有去中心化、不可修改的特性，天然就是一个安全的数据库，所以数据的存储方面可以部分存储于链上。
   但是由于所有操作都通过区块链查询实在太浪费时间了，所以需要结合链上链下数据库来提高查询效率。
   本项目的设计思路是：
   - 交易信息、合同的增删改操作、审核的过程以及结果、房产的增删改操作，需要上链
   - 用户信息、房产信息、合同信息、税收信息、审核信息等内容，存储在数据库中
2. 本项目希望能够充分利用hyperledger fabric的特性，例如多通道、可插拔式链码、私有数据PDC等
   目标是实现多点部署、支持上传自定义通道和链码、以及PDC保证交易私密性
   为了最大化利用区块链的特性，做了以下设计：
      - 去除了中介这个传统房地产交易中的重要环节，支持买卖双方能够在验资成功的情况下面对面进行商谈
3. 多通道设计
   1. 交易通道（Trade-Channel）
      - 成员：政府、买方、卖方、银行
      - 功能：处理房产挂牌、交易撮合、合同签署、产权变更。
   2. 资金通道（Fund-Channel）
      - 成员：银行、买方、卖方、审计
      - 功能：资金托管、结算、审计对账。
   3. 审计通道（Audit-Channel）
      - 成员：政府、审计机构
      - 功能：全量数据只读访问，用于合规检查。
4. 私有数据收集（PDC）设计：
   - 敏感数据隔离：买方/卖方身份信息、交易价格通过PDC存储，仅交易参与方可见。
   - 链上存Hash：将合同文件的IPFS哈希上链，原始文件通过链下存储（IPFS+访问控制）。

## 数据存储设计
| 数据类型 | 存储位置 | 说明 |
|---------|---------|------|
| 房产所有权记录 | 链上 | 不可篡改的核心数据（房产ID、所有人、历史交易） |
| 交易合同Hash | 链上 | 合同文件的IPFS哈希，确保完整性 |
| 买方/卖方身份信息 | 链上（PDC） | 隐私数据仅对交易参与方可见 |
| 资金流水 | 链上 | 托管账户变动记录，供审计验证 |
| 房产评估报告/照片 | 链下（IPFS） | 大文件存储，链上存哈希 |
| 用户隐私数据（如手机号） | 链下（数据库） | 加密存储于MySQL |

## 开发计划

本项目计划在2个月内完成开发，具体安排如下：

### 第一阶段：设计与环境搭建（2周）

| 周次 | 工作内容 | 交付物 |
|------|---------|--------|
| 第1周 | 详细需求分析、数据模型设计、系统架构细化 | 需求文档、架构设计文档、数据模型 |
| 第2周 | 开发环境搭建、区块链网络配置、基础设施准备 | 本地开发环境、测试网络、CI/CD流程 |

### 第二阶段：核心功能开发（4周）

| 周次 | 工作内容 | 交付物 |
|------|---------|--------|
| 第3周 | 智能合约开发（用户管理、房产管理） | 基础链码、单元测试 |
| 第4周 | 智能合约开发（交易管理、资金管理） | 交易链码、资金链码、集成测试 |
| 第5周 | 后端API开发（用户模块、房产模块）| REST API、数据库集成 |
| 第6周 | 后端API开发（交易、资金、合同模块）| REST API、区块链集成 |

### 第三阶段：前端与集成测试（2周）

| 周次 | 工作内容 | 交付物 |
|------|---------|--------|
| 第7周 | 前端开发（用户界面、房产管理、交易流程） | 用户界面、前后端集成 |
| 第8周 | 系统集成测试、性能优化、文档完善 | 测试报告、用户手册、部署文档 |

### 里程碑

1. M1（第2周末）：完成开发环境搭建和区块链网络部署
2. M2（第4周末）：完成所有智能合约开发和测试
3. M3（第6周末）：完成后端API开发和区块链集成
4. M4（第8周末）：系统全功能测试通过，准备发布

## 项目结构

```
/GRETS_System
├── application
│   ├── server    后端
│   └── web       前端
├── chaincode     链码
└── network       区块链网络启动脚本
```

## 系统架构图

```
+-------------------+     +-------------------+
| Vue3 前端         |<--->| Golang 服务端     |
+-------------------+     +-------------------+
                               |  REST API
                               v
+---------------------------------------------------+
| Hyperledger Fabric 网络                           |
|   - 交易通道（Trade-Channel）                     |
|   - 资金通道（Fund-Channel）                      |
|   - 审计通道（Audit-Channel）                     |
|   - PDC存储敏感数据                               |
+---------------------------------------------------+
                               |
                               v
+-------------------+     +-------------------+
| MySQL        |<--->| IPFS 存储         |
+-------------------+     +-------------------+
```

## 扩展性考虑
1. **跨链互操作**：未来可通过Fabric Interoperability连接土地管理局链。
2. **性能优化**：通过Fabric 2.5+的新特性（如Alpine镜像）减少节点资源占用。
3. **监管沙盒**：为政府提供模拟环境测试政策变更影响。

## 安装与部署

### 前提条件

- Docker和Docker Compose
- Go 1.23+
- Node.js 20+
- Vue CLI

### 部署步骤

1. 克隆仓库
2. 启动Fabric网络
3. 部署智能合约
4. 启动API服务
5. 启动前端应用

## 许可证

本项目采用MIT许可证。详情请参阅`LICENSE`文件。